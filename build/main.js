(()=>{"use strict";const e={inputSelector:".popup__input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_inactive",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"},t={inputSelector:"popup__input",formSelector:"popup__form"},s={openModifier:"popup_opened",closeBtnSelector:"popup__close-button"};class i{constructor(e,t,s){const{name:i,link:n}=e;this._selectorTemplate=t,this._handlerOpenImg=s,this._name=i,this._link=n}_getCardTemplate(){return document.querySelector(this._selectorTemplate).content.querySelector(".element").cloneNode(!0)}_getCard(){this._cardImage=this._element.querySelector(".element__picture"),this._cardName=this._element.querySelector(".element__name"),this._cardLike=this._element.querySelector(".element__like-button"),this._cardDelete=this._element.querySelector(".element__delete-button")}_setData(){this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardName.textContent=this._name}generateCardElement(){return this._element=this._getCardTemplate(),this._getCard(),this._setData(),this._setEventListeners(),this._element}_setEventListeners(){this._cardLike.addEventListener("click",this._handleLikeClick),this._cardDelete.addEventListener("click",this._handleDeleteCard),this._cardImage.addEventListener("click",this._handleImgClick)}_handleLikeClick=()=>{this._cardLike.classList.toggle("element__like-button_active")};_handleDeleteCard=()=>{this._element.remove()};_handleImgClick=()=>{this._handlerOpenImg({name:this._name,link:this._link})}}class n{constructor(e,{closeBtnSelector:t,openModifier:s}){this._popupSelector=e,this._popupElement=document.querySelector(`.${this._popupSelector}`),this.close=this.close.bind(this),this._openModifier=s,this._closeBtnSelector=t}open(){this._popupElement.addEventListener("click",this._handleCloseOverlayClick),document.addEventListener("keydown",this._handleEscClose),this._popupElement.classList.add(this._openModifier)}close(){this._popupElement.classList.remove(this._openModifier),this._popupElement.removeEventListener("click",this._handleCloseOverlayClick),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};_handleCloseOverlayClick=e=>{e.target===e.currentTarget&&this.close()};setEventListeners(){this._popupElement.querySelector(`.${this._closeBtnSelector}`).addEventListener("click",this.close)}}class r extends n{constructor(e,t,{formSelector:s,inputSelector:i},n,r,o=null){super(e,t),this._form=this._popupElement.querySelector(`.${s}`),this._submitHandler=n,this._getInfoHandler=o,this._inputList=Array.from(this._popupElement.querySelectorAll(`.${i}`)),this._resetErrorsHandler=r,this.open=this.open.bind(this),this.close=this.close.bind(this),this.setEventListeners=this.setEventListeners.bind(this)}open(){this._getInfoHandler?this._setInputValues(this._getInfoHandler()):this._form.reset(),this._resetErrorsHandler(),super.open()}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name.slice(6)]=t.value})),e}_setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name.slice(6)]}))}_handleFormSubmit=e=>{e.preventDefault(),this._submitHandler(this._getInputValues()),this.close()};setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",this._handleFormSubmit)}close(){super.close(),this._form.reset()}}const o=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__add-button"),a=new class extends n{constructor(e,t,{imageSelector:s,captionSelector:i}){super(e,t),this._imgElement=this._popupElement.querySelector(`.${s}`),this._captionElement=this._popupElement.querySelector(`.${i}`),this.open=this.open.bind(this)}open({name:e,link:t}){super.open(),this._imgElement.src=t,this._captionElement.textContent=e,this._imgElement.alt=e}}("popup_zoom",s,{imageSelector:"popup__picture",captionSelector:"popup__caption"});a.setEventListeners();const c=new class{constructor({titleSelector:e,jobSelector:t}){this._titleSelector=e,this._jobSelector=t,this._titleElement=document.querySelector(`.${this._titleSelector}`),this._jobElement=document.querySelector(`.${this._jobSelector}`),this.getUserInfo=this.getUserInfo.bind(this),this.setUserInfo=this.setUserInfo.bind(this)}getUserInfo(){const e={};return e.title=this._titleElement.textContent,e.about=this._jobElement.textContent,e}setUserInfo(e){this._titleElement.textContent=e.title,this._jobElement.textContent=e.about}}({titleSelector:"profile__title",jobSelector:"profile__about"}),_={};Array.from(document.forms).forEach((t=>{_[t.name]=new class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}_showInputError(e,t){const s=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),s.classList.add(this._errorClass),s.textContent=t}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}enableValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._toggleButtonState(),this._checkInputValidity(e)}))}))}cleanUpForm=()=>{this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}}(e,t),_[t.name].enableValidation()}));const h=new class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._containerSelector=s,this._container=document.querySelector(`.${this._containerSelector}`)}addItem(e){this._container.prepend(this._renderer(e))}rendererAll(){this._items.forEach((e=>{this.addItem(e)}))}}({items:[{name:"Букля.",link:"./images/ed00161cff818560935f679e8b9bd3e6e565a998r1-1280-1225v2_hq.jpg"},{name:"Шрам.",link:"./images/field_image_harry-lightning-bolt.jpg"},{name:"Гриффиндор.",link:"./images/iT7j7dmmb4Y.jpg"},{name:"Сливочное пиво.",link:"./images/slivochnoe-pivo-iz-garri-pottera-retsepty-prigotovleniya-lyubimogo-bezalkogolnogo-napitka-yunogo-volshebnika.jpg"},{name:"Снитч.",link:"./images/MV5BM2RhOTZhMDktYmEzMi00YTA4LTk1ZWQtNDQwZjdmNzM4Y2JiL2ltYWdlL2ltYWdlXkEyXkFqcGdeQXVyMjk3NTUyOTc@._V1_.jpg"},{name:"Хогвартс.",link:"./images/216771_or.jpg"}].reverse(),renderer:function(e){return new i(e,"#element-template",a.open).generateCardElement()}},"elements__items");h.rendererAll();const p=new r("popup_type_add-card",s,t,(e=>{h.addItem(e)}),_.place.cleanUpForm);p.setEventListeners(),l.addEventListener("click",p.open);const u=new r("popup_type_edit-profile",s,t,(e=>{c.setUserInfo(e)}),_.users.cleanUpForm,c.getUserInfo);u.setEventListeners(),o.addEventListener("click",u.open)})();